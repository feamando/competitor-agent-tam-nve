# Test info

- Name: Phase 5.4: Immediate Reports E2E Tests >> Cross-Browser Compatibility >> should work correctly in webkit
- Location: /Users/troy.edwards/code/competitor-agent-tam-nve/e2e/immediateReports.spec.ts:301:11

# Error details

```
Error: browserType.launch: Executable doesn't exist at /Users/troy.edwards/Library/Caches/ms-playwright/firefox-1482/firefox/Nightly.app/Contents/MacOS/firefox
╔═════════════════════════════════════════════════════════════════════════╗
║ Looks like Playwright Test or Playwright was just installed or updated. ║
║ Please run the following command to download new browsers:              ║
║                                                                         ║
║     npx playwright install                                              ║
║                                                                         ║
║ <3 Playwright Team                                                      ║
╚═════════════════════════════════════════════════════════════════════════╝
```

# Test source

```ts
  201 |
  202 |       // Verify estimated time indicators
  203 |       await expect(page.locator('[data-testid="estimated-completion-time"]')).toBeVisible();
  204 |
  205 |       // Verify progress percentage
  206 |       const progressPercentage = page.locator('[data-testid="progress-percentage"]');
  207 |       await expect(progressPercentage).toBeVisible();
  208 |       
  209 |       // Progress should start low and increase
  210 |       const initialProgress = await progressPercentage.textContent();
  211 |       expect(parseInt(initialProgress || '0')).toBeLessThan(50);
  212 |
  213 |       // Wait for completion
  214 |       await expect(page.locator('[data-testid="report-completed"]')).toBeVisible({
  215 |         timeout: E2E_CONFIG.timeouts.reportGeneration
  216 |       });
  217 |
  218 |       const finalProgress = await progressPercentage.textContent();
  219 |       expect(parseInt(finalProgress || '0')).toBe(100);
  220 |     });
  221 |   });
  222 |
  223 |   test.describe('Error Scenarios and Recovery', () => {
  224 |     test('should handle competitor snapshot capture failures gracefully', async ({ page }) => {
  225 |       test.setTimeout(E2E_CONFIG.timeouts.reportGeneration);
  226 |
  227 |       await page.goto('/projects/new');
  228 |
  229 |       // Create project with potentially problematic competitor URLs
  230 |       await page.fill('[data-testid="project-name"]', `Error Test ${Date.now()}`);
  231 |       await page.fill('[data-testid="product-website"]', 'https://error-test.com');
  232 |       
  233 |       // Add competitor with unreachable URL
  234 |       await page.fill('[data-testid="competitor-name-0"]', 'Unreachable Competitor');
  235 |       await page.fill('[data-testid="competitor-website-0"]', 'https://unreachable-competitor-12345.com');
  236 |
  237 |       await page.click('[data-testid="create-project"]');
  238 |       await page.waitForURL(/\/projects\/.*/, { timeout: E2E_CONFIG.timeouts.navigation });
  239 |
  240 |       const projectId = page.url().split('/projects/')[1];
  241 |       testProjectIds.push(projectId);
  242 |
  243 |       // Wait for snapshot capture to attempt and potentially fail
  244 |       await expect(page.locator('[data-testid="phase-snapshot-capture"]')).toBeVisible();
  245 |
  246 |       // Should proceed with partial data even if snapshots fail
  247 |       await expect(page.locator('[data-testid="partial-data-indicator"]')).toBeVisible({
  248 |         timeout: E2E_CONFIG.timeouts.elementInteraction
  249 |       });
  250 |
  251 |       // Verify fallback message is shown
  252 |       await expect(page.locator('[data-testid="snapshot-failure-message"]')).toBeVisible();
  253 |       await expect(page.locator('[data-testid="snapshot-failure-message"]')).toContainText(/capture failed|using existing data/i);
  254 |
  255 |       // Report should still be generated
  256 |       await expect(page.locator('[data-testid="report-completed"]')).toBeVisible({
  257 |         timeout: E2E_CONFIG.timeouts.reportGeneration
  258 |       });
  259 |
  260 |       // Verify quality indicators reflect the data limitations
  261 |       const completenessScore = await page.locator('[data-testid="report-completeness-score"]').textContent();
  262 |       expect(parseInt(completenessScore || '0')).toBeLessThan(70); // Should be lower due to failed snapshots
  263 |     });
  264 |
  265 |     test('should provide retry options when generation fails', async ({ page }) => {
  266 |       test.setTimeout(E2E_CONFIG.timeouts.reportGeneration);
  267 |
  268 |       await page.goto('/projects/new');
  269 |
  270 |       await page.fill('[data-testid="project-name"]', `Retry Test ${Date.now()}`);
  271 |       await page.fill('[data-testid="product-website"]', 'https://retry-test.com');
  272 |       
  273 |       await page.click('[data-testid="create-project"]');
  274 |       await page.waitForURL(/\/projects\/.*/, { timeout: E2E_CONFIG.timeouts.navigation });
  275 |
  276 |       const projectId = page.url().split('/projects/')[1];
  277 |       testProjectIds.push(projectId);
  278 |
  279 |       // Simulate or wait for potential failure
  280 |       // This might timeout or fail for various reasons
  281 |
  282 |       // If error occurs, verify retry options are available
  283 |       const errorIndicator = page.locator('[data-testid="report-generation-error"]');
  284 |       if (await errorIndicator.isVisible({ timeout: 5000 })) {
  285 |         // Verify retry options are provided
  286 |         await expect(page.locator('[data-testid="retry-button"]')).toBeVisible();
  287 |         await expect(page.locator('[data-testid="schedule-later-button"]')).toBeVisible();
  288 |         await expect(page.locator('[data-testid="proceed-without-report-button"]')).toBeVisible();
  289 |
  290 |         // Test retry functionality
  291 |         await page.click('[data-testid="retry-button"]');
  292 |         
  293 |         // Should restart the process
  294 |         await expect(page.locator('[data-testid="phase-validation"]')).toBeVisible();
  295 |       }
  296 |     });
  297 |   });
  298 |
  299 |   test.describe('Cross-Browser Compatibility', () => {
  300 |     E2E_CONFIG.browsers.forEach(browserName => {
> 301 |       test(`should work correctly in ${browserName}`, async ({ page, browserName: currentBrowser }) => {
      |           ^ Error: browserType.launch: Executable doesn't exist at /Users/troy.edwards/Library/Caches/ms-playwright/firefox-1482/firefox/Nightly.app/Contents/MacOS/firefox
  302 |         test.skip(currentBrowser !== browserName, `Skipping ${browserName} test in ${currentBrowser}`);
  303 |         
  304 |         test.setTimeout(E2E_CONFIG.timeouts.reportGeneration);
  305 |
  306 |         await page.goto('/projects/new');
  307 |
  308 |         await page.fill('[data-testid="project-name"]', `${browserName} Test ${Date.now()}`);
  309 |         await page.fill('[data-testid="product-website"]', `https://${browserName}-test.com`);
  310 |         await page.fill('[data-testid="competitor-name-0"]', `${browserName} Competitor`);
  311 |         await page.fill('[data-testid="competitor-website-0"]', `https://${browserName}-competitor.com`);
  312 |
  313 |         await page.click('[data-testid="create-project"]');
  314 |         await page.waitForURL(/\/projects\/.*/, { timeout: E2E_CONFIG.timeouts.navigation });
  315 |
  316 |         const projectId = page.url().split('/projects/')[1];
  317 |         testProjectIds.push(projectId);
  318 |
  319 |         // Verify core functionality works
  320 |         await expect(page.locator('[data-testid="initial-report-indicator"]')).toBeVisible();
  321 |         await expect(page.locator('[data-testid="progress-indicator"]')).toBeVisible();
  322 |
  323 |         // Wait for completion or reasonable timeout
  324 |         try {
  325 |           await expect(page.locator('[data-testid="report-completed"]')).toBeVisible({
  326 |             timeout: E2E_CONFIG.timeouts.reportGeneration
  327 |           });
  328 |         } catch (error) {
  329 |           // Log browser-specific issues but don't fail the test
  330 |           logger.warn(`Report generation timeout in ${browserName}`, {
  331 |             projectId,
  332 |             browser: browserName,
  333 |             error: error instanceof Error ? error.message : 'Unknown error'
  334 |           });
  335 |         }
  336 |       });
  337 |     });
  338 |   });
  339 |
  340 |   test.describe('Mobile Responsiveness', () => {
  341 |     E2E_CONFIG.viewports.forEach(viewport => {
  342 |       test(`should be responsive at ${viewport.width}x${viewport.height}`, async ({ page }) => {
  343 |         await page.setViewportSize(viewport);
  344 |         
  345 |         test.setTimeout(E2E_CONFIG.timeouts.reportGeneration);
  346 |
  347 |         await page.goto('/projects/new');
  348 |
  349 |         // Verify form is usable on this viewport
  350 |         const projectNameField = page.locator('[data-testid="project-name"]');
  351 |         await expect(projectNameField).toBeVisible();
  352 |         
  353 |         const createButton = page.locator('[data-testid="create-project"]');
  354 |         await expect(createButton).toBeVisible();
  355 |
  356 |         // Fill minimal form
  357 |         await page.fill('[data-testid="project-name"]', `Mobile Test ${viewport.width}x${viewport.height}`);
  358 |         await page.fill('[data-testid="product-website"]', 'https://mobile-test.com');
  359 |         await page.fill('[data-testid="competitor-name-0"]', 'Mobile Competitor');
  360 |         await page.fill('[data-testid="competitor-website-0"]', 'https://mobile-competitor.com');
  361 |
  362 |         await page.click('[data-testid="create-project"]');
  363 |         await page.waitForURL(/\/projects\/.*/, { timeout: E2E_CONFIG.timeouts.navigation });
  364 |
  365 |         const projectId = page.url().split('/projects/')[1];
  366 |         testProjectIds.push(projectId);
  367 |
  368 |         // Verify progress indicators are visible and usable on mobile
  369 |         const progressIndicator = page.locator('[data-testid="progress-indicator"]');
  370 |         await expect(progressIndicator).toBeVisible();
  371 |
  372 |         // On smaller screens, progress might be collapsed or simplified
  373 |         if (viewport.width < 768) {
  374 |           // Mobile-specific checks
  375 |           const mobileProgress = page.locator('[data-testid="mobile-progress-indicator"]');
  376 |           if (await mobileProgress.isVisible({ timeout: 2000 })) {
  377 |             await expect(mobileProgress).toBeVisible();
  378 |           }
  379 |         }
  380 |
  381 |         logger.info(`Mobile responsiveness test completed for ${viewport.width}x${viewport.height}`, {
  382 |           projectId,
  383 |           viewport
  384 |         });
  385 |       });
  386 |     });
  387 |   });
  388 |
  389 |   test.describe('Performance Under Load', () => {
  390 |     test('should handle multiple concurrent project creations', async ({ context }) => {
  391 |       test.setTimeout(E2E_CONFIG.timeouts.reportGeneration * 3);
  392 |
  393 |       const concurrentProjects = 3; // Reduced for E2E testing
  394 |       const pages: Page[] = [];
  395 |       const projectPromises: Promise<string>[] = [];
  396 |
  397 |       try {
  398 |         // Create multiple pages
  399 |         for (let i = 0; i < concurrentProjects; i++) {
  400 |           const page = await context.newPage();
  401 |           pages.push(page);
```